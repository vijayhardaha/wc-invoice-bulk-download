!function(e){const t={init:()=>{t.params=wc_pdf_invoices_bulk_download_params,t.dismissIcon='<span role="button" tabindex="0" class="dismiss"><svg height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></g></svg></span>',t.noticeIcon='<span class="notice-icon"><svg height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"></path></g></svg></span>',t.checkIcon='<span class="notice-icon"><svg height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"></path></g></svg></span>',t.noticeTimeout=!1,t.position=0,t.processing=!1,t.registerDownloadPDFEvents()},getElement:t=>e(document).find(t),showNotice:(e="info",n="",s="yes")=>{let o;if(clearTimeout(t.noticeTimeout),t.getElement(".notices-container").remove(),""===n)switch(e){case"success":n="Updated settings.";break;case"error":case"warning":n="Update settings failed.";break;default:n="Updating settings..."}o="success"===e?`<div class="notices-container"><div class="notice-box is-${e}">${t.checkIcon}<span class="notice-content"><span class="notice-text">${n}</span></span>${t.dismissIcon}</div></div>`:`<div class="notices-container"><div class="notice-box is-${e}">${t.noticeIcon}<span class="notice-content"><span class="notice-text">${n}</span></span>${t.dismissIcon}</div></div>`,t.getElement(".wc-pdf-invoices-bulk-download-container").append(o),"yes"===s&&(t.noticeTimeout=setTimeout((function(){t.getElement(".notices-container").fadeOut().remove()}),5e3))},removeAllNotices:()=>{t.getElement(".notices-container").remove()},registerNoticeEvents:()=>{e(document).on("click",".notice-box .dismiss",(n=>{n.preventDefault(),e(n.currentTarget).parents(".notice-box").hide().remove(),t.getElement(".notices-container").length&&""===t.getElement(".notices-container").html().trim()&&t.getElement(".notices-container").remove()}))},registerDatePickersEvents:()=>{t.getElement(".setting-field .datepicker").length&&t.getElement(".setting-field .datepicker").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+1",maxDate:"0"})},registerDownloadPDFEvents:()=>{t.registerNoticeEvents(),t.registerDatePickersEvents(),t.switchReportPeriod(),e(document).on("submit","form.wc-pdf-invoices-bulk-download-form",(function(n){n.preventDefault();const s=e(this);t.removeAllNotices(),t.form=s,t.data=s.serialize(),t.position=0,s.find(".btn").attr("disabled",!0),t.showNotice("info",t.params.messages.processing,"no"),e("html,body").animate({scrollTop:0},800),t.processing=!0,t.runAjax()})).on("change",".wc-pdf-invoices-bulk-download-form :input#setting-download-filter",(n=>{t.switchReportPeriod(e(n.currentTarget).val())}))},switchReportPeriod:(e="")=>{""===e&&(e=t.getElement(".wc-pdf-invoices-bulk-download-form :input#setting-download-filter").val()),"range-group"===e?(t.getElement(".wc-pdf-invoices-bulk-download-form #setting-row-month-year-range").hide(),t.getElement(".wc-pdf-invoices-bulk-download-form #setting-row-custom-date-range").slideDown()):(t.getElement(".wc-pdf-invoices-bulk-download-form #setting-row-custom-date-range").hide(),t.getElement(".wc-pdf-invoices-bulk-download-form #setting-row-month-year-range").slideDown())},runAjax:()=>{e.ajax({type:"POST",url:t.params.ajaxurl,data:t.data+"&position="+t.position,dataType:"json",success(e){if(e.success)!1!==e.data&&(t.position=e.data.position,e.data.percentage>=100?(t.processing=!1,t.form.find(".btn").attr("disabled",!1),t.showNotice("success",t.params.messages.success),window.location.href=e.data.download_url):setTimeout((()=>t.runAjax()),1e3));else{t.processing=!1,t.form.find(".btn").attr("disabled",!1);let n=t.params.messages.general_error;e.data&&(n=e.data.error),t.showNotice("error",n)}},error(e,n,s){t.form.find(".btn").attr("disabled",!1),t.processing=!1;let o=t.params.messages.server_error;s&&(o=s+". "+o),t.showNotice("error",o)}})}};t.init()}(jQuery);